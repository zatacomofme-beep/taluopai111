import { router } from '@kit.ArkUI';

@Component
export struct BottomNavBar {
  @Prop current: string = 'index'; // index | breathing | mood | profile

  @Builder
  NavItem(key: string, icon: string, label: string, targetUrl: string) {
    Column() {
      // å›¾æ ‡å®¹å™¨
      Stack() {
        if (this.current === key) {
          // é€‰ä¸­æ€çš„å…‰æ™•èƒŒæ™¯
          Circle({ width: 40, height: 40 })
            .fill('rgba(251, 114, 153, 0.1)')
            .scale({ x: 1, y: 1 })
            .animation({ duration: 300, curve: Curve.EaseOut })
        }
        Text(icon)
          .fontSize(24)
          .scale(this.current === key ? { x: 1.1, y: 1.1 } : { x: 1, y: 1 })
          .animation({ duration: 300, curve: Curve.Smooth })
      }
      .width(40)
      .height(40)

      // æ–‡å­—æ ‡ç­¾
      Text(label)
        .fontSize(10)
        .fontColor(this.current === key ? '#FB7299' : '#B0B0B0')
        .margin({ top: 4 })
        .fontWeight(this.current === key ? FontWeight.Medium : FontWeight.Normal)
    }
    .layoutWeight(1)
    .justifyContent(FlexAlign.Center)
    .stateStyles({
      pressed: {
        .scale({ x: 0.9, y: 0.9 })
      },
      normal: {
        .scale({ x: 1, y: 1 })
      }
    })
    .onClick(() => {
      if (this.current !== key) {
        router.replaceUrl({ url: targetUrl });
      }
    })
  }

  build() {
    Row() {
      this.NavItem('index', 'ğŸ”®', 'æŒ‡å¼•', 'pages/Index')
      this.NavItem('breathing', 'ğŸŒ¬ï¸', 'å‘¼å¸', 'pages/BreathingPage')
      this.NavItem('mood', 'ğŸ“', 'æ—¥è®°', 'pages/MoodPage')
      // æ–°å¢ï¼šä¸ªäººä¸­å¿ƒå…¥å£
      this.NavItem('profile', 'ğŸ‘¤', 'æˆ‘çš„', 'pages/ProfilePage')
    }
    .width('90%')
    .height(70)
    .backgroundColor('rgba(255, 255, 255, 0.9)') // ç•¥å¾®å¢åŠ ä¸é€æ˜åº¦
    .backdropBlur(20)
    .borderRadius(35)
    .shadow({ radius: 25, color: 'rgba(0,0,0,0.05)', offsetY: 8 })
    .padding({ left: 10, right: 10 })
    .margin({ bottom: 20 })
  }
}